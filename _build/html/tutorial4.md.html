<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Modelo del Dominio &mdash; Desarrollo con Java</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="Desarrollo con Java" href="index.html" />
    <link rel="next" title="6. Mapeo objeto/relacional" href="tutorial5.md.html" />
    <link rel="prev" title="3. Módulo de Tabla" href="tutorial3.md.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorial5.md.html" title="6. Mapeo objeto/relacional"
             accesskey="N">siguiente</a></li>
        <li class="right" >
          <a href="tutorial3.md.html" title="3. Módulo de Tabla"
             accesskey="P">anterior</a> |</li>
        <li><a href="index.html">Desarrollo con Java</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="modelo-del-dominio">
<h1>4. Modelo del Dominio<a class="headerlink" href="#modelo-del-dominio" title="Enlazar permanentemente con este título">¶</a></h1>
<p>A continuación se presenta el ejemplo de la aplicación Web de un Sistema
Universitario pero en este caso utilizando un <em>modelo del Dominio</em>.
Específicamente, en este ejemplo se combinarán otros patrones descritos
por Fowler: <em>modelo del dominio</em> para la lógica del dominio, y
<em>controlador de página</em> para la capa de presentación.</p>
<div class="section" id="la-capa-de-logica-del-dominio">
<h2>4.1. La capa de lógica del dominio<a class="headerlink" href="#la-capa-de-logica-del-dominio" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para implementar la capa de lógica del dominio se utilizará la técnica
de <em>modelo del dominio</em>. En este caso el modelo agrupa toda la lógica
del dominio, pero no se encarga del acceso a datos.</p>
<p>La primer clase necesaria consiste en la entidad profesor
<em>Profesor.java</em> y residirá en el directorio <em>/tutorial4/src/domain/</em>.
Esta clase es la que contendría la lógica del dominio.</p>
<div class="highlight-python"><div class="highlight"><pre>package domain;

public class Profesor {
  private int id;
  private String cedula;
  private String nombre;
  private String titulo;
  private String area;
  private String telefono;

  public Profesor () {};
  public void setId(int id) {this.id=id;}
  public void setCedula(String cedula) {this.cedula=cedula;}
  public void setNombre(String nombre) {this.nombre=nombre;}
  public void setTitulo(String titulo) throws Exception {
    if (titulo.toLowerCase().equals(&quot;bachiller&quot;) ||
        titulo.toLowerCase().equals(&quot;licenciado&quot;) ||
        titulo.toLowerCase().equals(&quot;master&quot;) ||
        titulo.toLowerCase().equals(&quot;doctor&quot;))
      this.titulo=titulo;
    else
      throw new Exception(&quot;Error en título de profesor&quot;);
  }
  public void setArea(String area) {this.area=area;}
  public void setTelefono(String telefono) {this.telefono=telefono;}

  public int getId() {return id;}
  public String getCedula() {return cedula;}
  public String getNombre() {return nombre;}
  public String getTitulo() {return titulo;}
  public String getArea() {return area;}
  public String getTelefono() {return telefono;}
}
</pre></div>
</div>
<div class="section" id="el-repositorio-de-datos">
<h3>4.1.1. El repositorio de datos<a class="headerlink" href="#el-repositorio-de-datos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para mantener almacenados y recuperar los diferentes objetos, se
utilizará un objeto llamado <em>ProfesorRepository.java</em> residente en el
mismo directorio <em>/tutorial4/src/domain/</em>. Esta clase mantendrá los
datos de los objetos en memoria. Por tanto no será necesario utilizar
una base de datos en este tutorial.</p>
<div class="highlight-python"><div class="highlight"><pre>package domain;

import java.util.Map;
import java.util.HashMap;
import java.util.Collection;

public class ProfesorRepository {
  private Map&lt;String,Profesor&gt; profesores;

  ProfesorRepository() {
    profesores = new HashMap&lt;String,Profesor&gt;();
  }
  public boolean insertProfesor(Profesor prof) {
    if (profesores.containsKey(prof.getId()))
      return false;
    else
      profesores.put(prof.getId()+&quot;&quot;,prof);
    return true;
  }
  public boolean deleteProfesor(Profesor prof) {
    if (!profesores.containsKey(prof.getId()))
      return false;
    else
      profesores.remove(prof.getId());
    return true;
  }
  public Profesor findProfesor(String id) {
    if (!profesores.containsKey(id))
      return null;
    else
      return profesores.get(id);
  }
  public boolean updateProfesor(Profesor prof) {
    if (!profesores.containsKey(prof.getId()+&quot;&quot;))
      return false;
    else
      profesores.put(prof.getId()+&quot;&quot;,prof);
    return true;
  }
  public Collection findAllProfesor() {
    return profesores.values();
  }
  public void setProfesores(Map profesores) {
    this.profesores = profesores;
  }
}
</pre></div>
</div>
</div>
<div class="section" id="la-fabrica-de-objetos">
<h3>4.1.2. La fábrica de objetos<a class="headerlink" href="#la-fabrica-de-objetos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Generalmente cuando se elabora un modelo del dominio es importante crear
una clase aparte que se encargue de crear instancias de objetos. En este
caso se utilizará la clase <em>ProfesorFactory.java</em> y se ubicará en el
mismo directorio <em>/tutorial4/src/domain/</em></p>
<div class="highlight-python"><div class="highlight"><pre>package domain;

public class ProfesorFactory {
  public Profesor Create(int id,String cedula,String nombre,
                  String titulo,String area,String telefono) {
    try {
      Profesor prof = new Profesor();
      prof.setId(id);
      prof.setCedula(cedula);
      prof.setNombre(nombre);
      prof.setTitulo(titulo);
      prof.setArea(area);
      prof.setTelefono(telefono);
      return prof;
    } catch (Exception e) {
      return null;
    }
  }
}
</pre></div>
</div>
</div>
<div class="section" id="compilando-la-capa-del-dominio">
<h3>4.1.3. Compilando la capa del dominio<a class="headerlink" href="#compilando-la-capa-del-dominio" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Se puede realizar la compilación de estas tres clases en forma separada
del resto del código. La siguiente instrucción para ejecutar la
compilación puede estar definida en un archivo <em>compileDomainLayer.bat</em>
residente en el directorio <em>/tutorial4/</em> (todo en una sola línea):</p>
<div class="highlight-python"><div class="highlight"><pre>javac -d root/WEB-INF/classes src/domain/Profesor.java
  src/domain/ProfesorFactory.java src/domain/ProfesorRepository.java
</pre></div>
</div>
<p>Nota: La versión del JDK debe ser superior a 6.0</p>
</div>
</div>
<div class="section" id="capa-de-presentacion">
<h2>4.2. Capa de presentación<a class="headerlink" href="#capa-de-presentacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El servicio de la universidad ha será implementado mediante
<em>controladores de página</em>, en donde cada página se implementa como un
controlador individual. La clase general para definir los controladores
se llama <em>PageController.java</em> y debe residir en el directorio
<em>/tutorial4/src/display/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;

import java.io.*;
import java.util.*;
import javax.servlet.*;
import javax.servlet.http.*;

import org.springframework.web.context.*;
import org.springframework.web.context.support.*;

public class PageController extends HttpServlet {

  protected WebApplicationContext context;

  public void init(ServletConfig config) throws ServletException {
    super.init(config);
    context =
      WebApplicationContextUtils.getWebApplicationContext(getServletContext());
  }

   protected void forward(String target, HttpServletRequest request,
                    HttpServletResponse response)
    throws ServletException, IOException {
    RequestDispatcher dispatcher =
      context.getServletContext().getRequestDispatcher(target);
    dispatcher.forward(request,response);
  }
}
</pre></div>
</div>
<div class="section" id="el-controlador-de-listado-de-profesores">
<h3>4.2.1. El controlador de listado de profesores<a class="headerlink" href="#el-controlador-de-listado-de-profesores" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El primer controlador de página es el que permite mostrar el listado de
profesores. Este archivo se llama <em>ListaProfesores.java</em> y reside en el
mismo directorio <em>/tutorial4/src/display/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;
import java.util.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.springframework.web.context.*;

import domain.ProfesorRepository;
import domain.Profesor;

public class ListaProfesores extends PageController {

  public void doGet(HttpServletRequest request,
                    HttpServletResponse response)
    throws ServletException, IOException {
      ProfesorRepository profesores =
        (ProfesorRepository) context.getBean(&quot;profesorRepository&quot;);
    try {
            Collection lista = profesores.findAllProfesor();
            List data = new ArrayList();
            Iterator itr = lista.iterator();
            while (itr.hasNext()) {
                Profesor prof = (Profesor)itr.next();
                ProfesorDTO dto = ProfesorAssembler.Create(prof);
                data.add(dto);
            }
      request.setAttribute(&quot;profesores&quot;,data);
      forward(&quot;/listaProfesores.jsp&quot;,request,response);
        } catch (Exception e) {
            request.setAttribute(&quot;mensaje&quot;,e.getMessage());
            forward(&quot;/paginaError.jsp&quot;,request,response);
        }
  }
}
</pre></div>
</div>
<div class="section" id="la-plantilla-jsp">
<h4>4.2.1.1. La plantilla JSP<a class="headerlink" href="#la-plantilla-jsp" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Adicionalmente se utilizará, con en el tutorial anterior, una
<em>plantilla</em> JSP para realizar el formateo de página en código HTML. El
archivo <em>listaProfesores.jsp</em> se encarga de esta tarea y residirá en el
directorio <em>/tutorial4/root/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;%@ page import=&quot;java.util.*&quot; %&gt;
&lt;%@ page import=&quot;display.*&quot; %&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Sistema Universitario&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
  &lt;/head&gt;
  &lt;h1&gt;Sistema Universitario&lt;/h1&gt;
  &lt;h2&gt;Listado de profesores&lt;/h2&gt;
  &lt;% List profs = (List)request.getAttribute(&quot;profesores&quot;); %&gt;
  &lt;table&gt;
    &lt;thead&gt;
    &lt;tr&gt;&lt;th&gt;Nombre&lt;/th&gt;&lt;th&gt;T&amp;iacute;tulo&lt;/th&gt;&lt;th&gt;Area&lt;/th&gt;&lt;th&gt;Acciones&lt;/th&gt;&lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    &lt;% for(int i = 0, n = profs.size(); i &lt; n; i++) {
         ProfesorDTO prof = (ProfesorDTO) profs.get(i); %&gt;
        &lt;tr&gt;&lt;td&gt;&lt;%= prof.nombre %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= prof.titulo %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;%= prof.area %&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#39;/detalleProfesor?id=&lt;%= prof.id %&gt;&#39;&gt;
              &lt;input type=&quot;submit&quot; value=&quot;Detalle&quot;/&gt;&lt;/a&gt;
            &lt;a href=&#39;/eliminarProfesor?id=&lt;%= prof.id %&gt;&#39;&gt;
              &lt;input type=&quot;submit&quot; value=&quot;Eliminar&quot;/&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;% } %&gt;
  &lt;/tbody&gt;
    &lt;tfoot&gt;
      &lt;tr&gt;&lt;td&gt;&lt;a href=&#39;/agregarProfesor&#39;&gt;
        &lt;input type=&quot;submit&quot; name=&quot;action&quot; value=&quot;Agregar&quot;/&gt;&lt;/a&gt;
      &lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;/tfoot&gt;
  &lt;/table&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>Nótese que la tabla generada cuenta con enlaces que invocarán la rutina
que presenta el detalle del profesor (que se describe a continuación).</p>
</div>
<div class="section" id="hoja-de-estilo">
<h4>4.2.1.2. Hoja de estilo<a class="headerlink" href="#hoja-de-estilo" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Con el fin de mejorar la apariencia de este ejemplo se ha desarrollado
una pequeña hoja de estilo (css) que permite organizar mejor los datos
de la tabla y el formulario. El archivo llamado <em>style.css</em> cuenta con
el siguiente código y y reside en el directorio <em>/tutorial4/root/</em>.:</p>
<div class="highlight-python"><div class="highlight"><pre>body {
  line-height: 1.6em;
  font-family:&quot;Lucida Sans Unicode&quot;, &quot;Lucida Grande&quot;, Sans-Serif;
  color: #009;
}
table {
  font-size: 12px;
  margin: 45px;
  width: 480px;
  text-align: left;
  border-collapse: collapse;
}
th, tfoot td {
  font-size: 13px;
  font-weight: normal;
  padding: 8px;
  background: #b9c9fe;
  border-top: 4px solid #aabcfe;
  border-bottom: 1px solid #fff;
  color: #039;
  text-align: center;
}
td {
  padding: 8px;
  background: #e8edff;
  border-bottom: 1px solid #fff;
  color: #669;
  border-top: 1px solid transparent;
}
tr:hover td {
  background: #d0dafd;
  color: #339;
}
input[type=&quot;text&quot;] {
  width: 250px;
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="el-controlador-de-detalle-de-profesor">
<h3>4.2.2. El controlador de detalle de profesor<a class="headerlink" href="#el-controlador-de-detalle-de-profesor" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El controlador de detalle de profesor presentará otra tabla HTML con la
información detallada del profesor. Este controlador es llamado
<em>DetalleProfesor.java</em> y se ubica en el mismo directorio
<em>/tutorial4/src/display</em>. Es importante observar la utilización del <em>id</em>
del profesor para realizar la consulta al módula de tabla.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;
import java.util.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.springframework.web.context.*;

import domain.ProfesorRepository;
import domain.Profesor;

public class DetalleProfesor extends PageController {

  public void doGet(HttpServletRequest request,
                    HttpServletResponse response)
    throws ServletException, IOException {
      ProfesorRepository profesores =
          (ProfesorRepository) context.getBean(&quot;profesorRepository&quot;);
    try {
            String id = request.getParameter(&quot;id&quot;);
            int idProf = Integer.parseInt(id);
            Profesor prof = profesores.findProfesor(idProf+&quot;&quot;);
            ProfesorDTO dto = ProfesorAssembler.Create(prof);
      request.setAttribute(&quot;profesor&quot;,dto);
      forward(&quot;/detalleProfesor.jsp&quot;,request,response);
        } catch (Exception e) {
            request.setAttribute(&quot;mensaje&quot;,e.getMessage());
            forward(&quot;/paginaError.jsp&quot;,request,response);
        }
  }
}
</pre></div>
</div>
<div class="section" id="plantilla-jsp">
<h4>4.2.2.1. Plantilla JSP<a class="headerlink" href="#plantilla-jsp" title="Enlazar permanentemente con este título">¶</a></h4>
<p>La plantilla JSP que genera el código HTML del detalle del profesor, se
presenta a continuación. El código de la plantilla se define en un
archivo llamado <em>detalleProfesor.jsp</em> que reside también en el
directorio <em>/tutorial4/root/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;%@ page import=&quot;java.util.Map&quot; %&gt;
&lt;%@ page import=&quot;display.*&quot; %&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;/&gt;
    &lt;title&gt;Sistema Universitario&lt;/title&gt;
     &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
  &lt;/head&gt;
  &lt;h1&gt;Sistema Universitario&lt;/h1&gt;
  &lt;h2&gt;Detalle de Profesor&lt;/h2&gt;
  &lt;% ProfesorDTO prof = (ProfesorDTO)request.getAttribute(&quot;profesor&quot;); %&gt;
  &lt;form name=&quot;ActualizarProfesor&quot; action=&quot;/actualizarProfesor&quot; method=&quot;get&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;&lt;%= prof.id %&gt;&quot;/&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    &lt;tr&gt;&lt;td&gt;Nombre:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;nombre&quot;
       value=&quot;&lt;%= prof.nombre %&gt;&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;C&amp;eacute;dula:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;cedula&quot;
       value=&quot;&lt;%= prof.cedula %&gt;&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;T&amp;iacute;tulo:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;titulo&quot;
       value=&quot;&lt;%= prof.titulo %&gt;&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;Area:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;area&quot;
       value=&quot;&lt;%= prof.area %&gt;&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td&gt;Tel&amp;eacute;fono:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;telefono&quot;
       value=&quot;&lt;%= prof.telefono %&gt;&quot;/&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;tfoot&gt;
    &lt;tr&gt;&lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;Actualizar&quot; /&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;/tfoot&gt;
  &lt;/table&gt;
  &lt;/form&gt;
&lt;/html&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="el-controlador-para-actualizar-informacion">
<h3>4.2.3. El controlador para actualizar información<a class="headerlink" href="#el-controlador-para-actualizar-informacion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Se presenta también el controlador de página que permite actualizar los
datos de un profesor. La lógica de este controlador se ubica en el
archivo <em>ActualizarProfesor.java</em> y reside en el directorio
<em>/tutorial4/src/display/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;
import java.util.*;
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import org.springframework.web.context.*;

import domain.ProfesorRepository;
import domain.Profesor;

public class ActualizarProfesor extends PageController {

  public void doGet(HttpServletRequest request,
                    HttpServletResponse response)
    throws ServletException, IOException {
      ProfesorRepository profesores =
        (ProfesorRepository) context.getBean(&quot;profesorRepository&quot;);
    try {
            String id = request.getParameter(&quot;id&quot;);
            int idProf = Integer.parseInt(id);
            String cedula = request.getParameter(&quot;cedula&quot;);
            String nombre = request.getParameter(&quot;nombre&quot;);
            String titulo = request.getParameter(&quot;titulo&quot;);
            String area = request.getParameter(&quot;area&quot;);
            String telefono = request.getParameter(&quot;telefono&quot;);
            Profesor prof = profesores.findProfesor(idProf+&quot;&quot;);
            try {
                if (cedula!=null) prof.setCedula(cedula);
                if (nombre!=null) prof.setNombre(nombre);
                if (titulo!=null) prof.setTitulo(titulo);
                if (area!=null) prof.setArea(area);
                if (telefono!=null) prof.setTelefono(telefono);
            } catch (Exception e) {}
      response.sendRedirect(&quot;listaProfesores&quot;);
        } catch (Exception e) {
            request.setAttribute(&quot;mensaje&quot;,e.getMessage());
            forward(&quot;/paginaError.jsp&quot;,request,response);
        }
  }
}
</pre></div>
</div>
</div>
<div class="section" id="el-dto-de-profesor">
<h3>4.2.4. El DTO de profesor<a class="headerlink" href="#el-dto-de-profesor" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En esta implementación se utiliza una clase tipo DTO (Data Transfer
Object) que facilite el paso de información hacia las vistas de datos.
Para ello se utiliza la clase <em>ProfesorDTO.java</em> residente en el
directorio <em>/tutorial4/src/display/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;

public class ProfesorDTO {
  public int id;
  public String cedula;
  public String nombre;
  public String titulo;
  public String area;
  public String telefono;
}
</pre></div>
</div>
<div class="section" id="el-ensamblador-del-dto">
<h4>4.2.4.1. El ensamblador del DTO<a class="headerlink" href="#el-ensamblador-del-dto" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Adicionalmente es necesario contar con una clase que realice el
ensamblaje del DTO a partir de la entidad de profesor. Aquí se utiliza
la clase <em>ProfesorAssembler.java</em> residente en el mismo directorio
<em>/tutorial4/src/display/</em>.</p>
<div class="highlight-python"><div class="highlight"><pre>package display;

import domain.Profesor;

public class ProfesorAssembler {
  public static ProfesorDTO Create(Profesor prof) {
    ProfesorDTO dto = new ProfesorDTO();
    dto.id = prof.getId();
    dto.cedula = prof.getCedula();
    dto.nombre = prof.getNombre();
    dto.titulo = prof.getTitulo();
    dto.area = prof.getArea();
    dto.telefono = prof.getTelefono();
    return dto;
  }
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="compilando-la-capa-de-presentacion">
<h3>4.2.5. Compilando la capa de presentación<a class="headerlink" href="#compilando-la-capa-de-presentacion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para compilar la capa de presentación es necesario contar con las
librerías del framework <em>Spring 3</em> (como se indicó antes) y con la
librería *servlet-api.jar** ubicadas en el directorio
<em>/tutorial4/root/WEB-INF/lib/</em>.</p>
<p>Específicamente las librerías necesarias son las siguientes:</p>
<ul class="simple">
<li>servlet-api.jar</li>
<li>spring-asm-3.2.0.M1.jar</li>
<li>spring-beans-3.2.0.M1.jar</li>
<li>spring-context-3.2.0.M1.jar</li>
<li>spring-core-3.2.0.M1.jar</li>
<li>spring-expression-3.2.0.M1.jar</li>
<li>spring-jdbc-3.2.0.M1.jar</li>
<li>spring-tx.3.2.0.M1.jar</li>
<li>spring-web-3.2.0.M1.jar</li>
</ul>
<p>La siguiente instrucción para ejecutar la compilación puede estar
definida en un archivo <em>compileDisplayLayer.bat</em> residente en el
directorio <em>/tutorial4/</em> (todo en una sola línea):</p>
<div class="highlight-python"><div class="highlight"><pre>javac -cp &quot;root/WEB-INF/classes&quot;;&quot;root/WEB-INF/lib/*&quot;
  -d root/WEB-INF/classes src/display/PageController.java
  src/display/ActualizarProfesor.java src/display/DetalleProfesor.java
  src/display/ListaProfesores.java src/display/ProfesorAssembler.java
  src/display/ProfesorDTO.java
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuracion-del-contexto">
<h2>4.3. Configuración del contexto<a class="headerlink" href="#configuracion-del-contexto" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El framework <em>Spring</em> permite crear archivos <em>xml</em> que definen la
configuración del contexto de ejecución de la aplicación. El archivo de
configuración llamado <em>context.xml</em> se deberá ubicar en el directorio
<em>/tutorial4/root/WEB-INF/</em> y contendrá la siguiente información.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xmlns:context=&quot;http://www.springframework.org/schema/context&quot;
  xsi:schemaLocation=&quot;
    http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&gt;
  &lt;bean id=&quot;profesorRepository&quot; class=&quot;domain.ProfesorRepository&quot;&gt;
    &lt;property name=&quot;profesores&quot;&gt;
      &lt;map&gt;
        &lt;entry&gt;
          &lt;key&gt;&lt;value&gt;1&lt;/value&gt;&lt;/key&gt;
          &lt;ref bean=&quot;P001&quot; /&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;key&gt;&lt;value&gt;2&lt;/value&gt;&lt;/key&gt;
          &lt;ref bean=&quot;P002&quot; /&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;key&gt;&lt;value&gt;3&lt;/value&gt;&lt;/key&gt;
          &lt;ref bean=&quot;P003&quot; /&gt;
        &lt;/entry&gt;
      &lt;/map&gt;
    &lt;/property&gt;
  &lt;/bean&gt;
  &lt;bean id=&quot;P001&quot; class=&quot;domain.Profesor&quot;&gt;
     &lt;property name=&quot;id&quot; value=&quot;1&quot;/&gt;
     &lt;property name=&quot;cedula&quot; value=&quot;101110111&quot;/&gt;
     &lt;property name=&quot;nombre&quot; value=&quot;Carlos Perez&quot;/&gt;
     &lt;property name=&quot;titulo&quot; value=&quot;Licenciado&quot;/&gt;
     &lt;property name=&quot;area&quot; value=&quot;Administracion&quot;/&gt;
     &lt;property name=&quot;telefono&quot; value=&quot;3456-7890&quot;/&gt;
  &lt;/bean&gt;
  &lt;bean id=&quot;P002&quot; class=&quot;domain.Profesor&quot;&gt;
     &lt;property name=&quot;id&quot; value=&quot;2&quot;/&gt;
     &lt;property name=&quot;cedula&quot; value=&quot;202220222&quot;/&gt;
     &lt;property name=&quot;nombre&quot; value=&quot;Luis Torres&quot;/&gt;
     &lt;property name=&quot;titulo&quot; value=&quot;Master&quot;/&gt;
     &lt;property name=&quot;area&quot; value=&quot;Economia&quot;/&gt;
     &lt;property name=&quot;telefono&quot; value=&quot;6677-3456&quot;/&gt;
  &lt;/bean&gt;
  &lt;bean id=&quot;P003&quot; class=&quot;domain.Profesor&quot;&gt;
     &lt;property name=&quot;id&quot; value=&quot;3&quot;/&gt;
     &lt;property name=&quot;cedula&quot; value=&quot;303330333&quot;/&gt;
     &lt;property name=&quot;nombre&quot; value=&quot;Juan Castro&quot;/&gt;
     &lt;property name=&quot;titulo&quot; value=&quot;Licenciado&quot;/&gt;
     &lt;property name=&quot;area&quot; value=&quot;Matematica&quot;/&gt;
     &lt;property name=&quot;telefono&quot; value=&quot;6755-7788&quot;/&gt;
  &lt;/bean&gt;
&lt;/beans&gt;
</pre></div>
</div>
<p>Los aspectos importantes que se pueden observar en este archivo son la
declaración de una instancia (singleton) del repositorio de profesores y
la forma como se crean los objetos en forma dinámica.</p>
</div>
<div class="section" id="configuracion-del-servidor">
<h2>4.4. Configuración del servidor<a class="headerlink" href="#configuracion-del-servidor" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El servidor de servlets requiere del archivo de configuración de la
aplicación para conocer en donde se ubica la clase a ejecutar. Además
este archivo permite indicar la ubicación y nombre del archivo de
contexto. Estos archivos de configuración del servlet siempre se llaman
<em>web.xml</em> y deben residir en el directorio <em>/tutorial4/root/WEB-INF/</em>.
Para este caso su contenido sería el siguiente:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;web-app xmlns=&quot;http://java.sun.com/xml/ns/j2ee&quot;
   xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
   xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/j2ee
                       http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd&quot;
   version=&quot;2.4&quot;&gt;
 &lt;display-name&gt;Sistema Universitario&lt;/display-name&gt;
 &lt;description&gt;Ejemplo de Rutinas de Transaccion&lt;/description&gt;
 &lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;/WEB-INF/context.xml&lt;/param-value&gt;
 &lt;/context-param&gt;
 &lt;listener&gt;
    &lt;listener-class&gt;
      org.springframework.web.context.ContextLoaderListener
    &lt;/listener-class&gt;
 &lt;/listener&gt;
 &lt;servlet&gt;
   &lt;servlet-name&gt;ActualizarProfesor&lt;/servlet-name&gt;
   &lt;servlet-class&gt;display.ActualizarProfesor&lt;/servlet-class&gt;
 &lt;/servlet&gt;
 &lt;servlet&gt;
   &lt;servlet-name&gt;DetalleProfesor&lt;/servlet-name&gt;
   &lt;servlet-class&gt;display.DetalleProfesor&lt;/servlet-class&gt;
 &lt;/servlet&gt;
 &lt;servlet&gt;
   &lt;servlet-name&gt;ListaProfesores&lt;/servlet-name&gt;
   &lt;servlet-class&gt;display.ListaProfesores&lt;/servlet-class&gt;
 &lt;/servlet&gt;
 &lt;servlet-mapping&gt;
   &lt;servlet-name&gt;ActualizarProfesor&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/root/actualizarProfesor&lt;/url-pattern&gt;
 &lt;/servlet-mapping&gt;
 &lt;servlet-mapping&gt;
   &lt;servlet-name&gt;DetalleProfesor&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/root/detalleProfesor&lt;/url-pattern&gt;
 &lt;/servlet-mapping&gt;
 &lt;servlet-mapping&gt;
   &lt;servlet-name&gt;ListaProfesores&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/root/listaProfesores&lt;/url-pattern&gt;
 &lt;/servlet-mapping&gt;
&lt;/web-app&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="ejecucion-del-tutorial">
<h1>5. Ejecución del tutorial<a class="headerlink" href="#ejecucion-del-tutorial" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Este ejemplo se puede ejecutar bajo cualquier contenedor de Servlet. Por
ejemplo, para realizar la ejecución de pruebas se puede utilizar un
producto como el <em>Winstone Servlet Container</em> que permite ejecutar
servlets de forma muy sencilla. Se debe descargar el programa
<em>winstone-0.9.10.jar</em> y copiarlo en el directorio <em>/tutorial4/</em>. Sin
embargo, para lograr que <em>Winstone</em> ejecute plantillas <em>JSP</em> es
necesario descargar algunas librerías adicionales que deben ser copiadas
en el directorio <em>/tutorial4/lib</em>:</p>
<ul class="simple">
<li>el-api-6.0.18.jar</li>
<li>jasper-6.0.18.jar</li>
<li>jasper-el-6.0.18.jar</li>
<li>jasper-jdt-6.0.18.jar</li>
<li>jsp-api-6.0.18.jar</li>
<li>jstl-api-1.2.jar</li>
<li>jstl-impl-1.2.jar</li>
<li>jtds-1.2.4.jar</li>
<li>juli-6.0.18.jar</li>
<li>servlet-api-2.5.jar</li>
<li>servlet-api.jar</li>
</ul>
<p>Para ejecutar el servidor de servlets se puede crear un archivo de
instrucciones, llamado <em>run.bat</em>, similar al siguiente en el directorio
<em>/tutorial4/</em> (todo en una sola línea):</p>
<div class="highlight-python"><div class="highlight"><pre>java -jar winstone-0.9.10.jar --httpPort=8089 --commonLibFolder=lib
 --useJasper=true --webroot=root
</pre></div>
</div>
<p>Luego se puede acceder a la aplicación desde cualquier visualizador web
y apuntando a la dirección <a class="reference external" href="http://localhost:8089/listaProfesores">http://localhost:8089/listaProfesores</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Tabla de Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">4. Modelo del Dominio</a><ul>
<li><a class="reference internal" href="#la-capa-de-logica-del-dominio">4.1. La capa de lógica del dominio</a><ul>
<li><a class="reference internal" href="#el-repositorio-de-datos">4.1.1. El repositorio de datos</a></li>
<li><a class="reference internal" href="#la-fabrica-de-objetos">4.1.2. La fábrica de objetos</a></li>
<li><a class="reference internal" href="#compilando-la-capa-del-dominio">4.1.3. Compilando la capa del dominio</a></li>
</ul>
</li>
<li><a class="reference internal" href="#capa-de-presentacion">4.2. Capa de presentación</a><ul>
<li><a class="reference internal" href="#el-controlador-de-listado-de-profesores">4.2.1. El controlador de listado de profesores</a><ul>
<li><a class="reference internal" href="#la-plantilla-jsp">4.2.1.1. La plantilla JSP</a></li>
<li><a class="reference internal" href="#hoja-de-estilo">4.2.1.2. Hoja de estilo</a></li>
</ul>
</li>
<li><a class="reference internal" href="#el-controlador-de-detalle-de-profesor">4.2.2. El controlador de detalle de profesor</a><ul>
<li><a class="reference internal" href="#plantilla-jsp">4.2.2.1. Plantilla JSP</a></li>
</ul>
</li>
<li><a class="reference internal" href="#el-controlador-para-actualizar-informacion">4.2.3. El controlador para actualizar información</a></li>
<li><a class="reference internal" href="#el-dto-de-profesor">4.2.4. El DTO de profesor</a><ul>
<li><a class="reference internal" href="#el-ensamblador-del-dto">4.2.4.1. El ensamblador del DTO</a></li>
</ul>
</li>
<li><a class="reference internal" href="#compilando-la-capa-de-presentacion">4.2.5. Compilando la capa de presentación</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuracion-del-contexto">4.3. Configuración del contexto</a></li>
<li><a class="reference internal" href="#configuracion-del-servidor">4.4. Configuración del servidor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ejecucion-del-tutorial">5. Ejecución del tutorial</a></li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="tutorial3.md.html"
                        title="capítulo anterior">3. Módulo de Tabla</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="tutorial5.md.html"
                        title="próximo capítulo">6. Mapeo objeto/relacional</a></p>
<div id="searchbox" style="display: none">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Introduzca los términos de búsqueda o un nombre de módulo, clase o función.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="tutorial5.md.html" title="6. Mapeo objeto/relacional"
             >siguiente</a></li>
        <li class="right" >
          <a href="tutorial3.md.html" title="3. Módulo de Tabla"
             >anterior</a> |</li>
        <li><a href="index.html">Desarrollo con Java</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Armando Arce.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>